#if 0
	shc Version 4.0.1, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f termo-git.sh 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\376"
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\075\103\327\117\151\162\262\353\122\063\123\037\175\126\322\065"
	"\331\022\034\250\225\317\173\226\126"
#define      date_z	1
#define      date	((&data[26]))
	"\020"
#define      pswd_z	256
#define      pswd	((&data[60]))
	"\112\074\323\052\031\345\345\351\331\124\177\171\111\366\364\357"
	"\234\225\260\332\330\207\125\157\335\203\212\304\206\017\127\321"
	"\113\104\260\234\255\130\313\250\276\037\062\360\252\131\032\045"
	"\377\303\007\336\016\005\304\116\320\150\140\265\273\022\255\212"
	"\126\136\047\004\266\362\254\165\022\336\146\274\070\200\342\070"
	"\104\351\026\122\357\333\241\277\103\001\164\377\023\042\212\151"
	"\200\261\156\066\243\032\254\266\371\022\162\062\223\124\152\327"
	"\076\201\052\055\134\314\355\240\315\141\240\341\204\052\113\004"
	"\333\271\072\177\323\347\065\315\371\250\377\215\375\151\144\073"
	"\352\217\151\106\133\126\347\051\270\207\012\074\261\126\101\215"
	"\017\173\014\343\143\102\260\134\352\260\352\350\031\116\043\003"
	"\336\215\112\071\344\061\142\234\271\155\331\152\304\032\370\323"
	"\226\005\267\371\107\150\126\062\030\101\032\062\220\076\065\156"
	"\314\200\247\260\261\012\115\153\170\047\325\074\102\316\020\330"
	"\323\310\322\032\061\051\115\111\152\150\173\372\247\261\151\163"
	"\061\020\043\343\033\161\116\224\230\044\321\332\363\342\263\306"
	"\252\206\341\334\260\056\045\033\227\241\026\076\123\177\261\205"
	"\220\325\150\254\107\267\100\340\334\022\272\317\364\156\226\237"
	"\365\052\374\145\017\341\116\351\066\315\143\200\304\127\157\141"
	"\355\040\073\306\247\220\065\205\024\300\111\232\320\240\154\034"
	"\313\150\201\333\112\317"
#define      opts_z	1
#define      opts	((&data[353]))
	"\326"
#define      shll_z	8
#define      shll	((&data[354]))
	"\320\203\253\263\225\217\312\041\177"
#define      tst1_z	22
#define      tst1	((&data[367]))
	"\220\375\063\070\354\261\074\064\162\323\116\074\111\017\271\037"
	"\137\225\326\036\254\211\051\324\155\151\216\151"
#define      text_z	5327
#define      text	((&data[1239]))
	"\007\075\372\250\252\026\164\022\230\117\135\150\024\336\005\074"
	"\337\147\274\117\052\051\340\050\135\031\267\307\326\132\361\336"
	"\230\354\207\102\002\373\125\233\112\262\003\137\220\010\233\160"
	"\160\130\300\232\202\240\302\337\271\171\247\220\324\230\157\154"
	"\204\366\256\207\361\003\042\074\266\045\233\106\056\067\267\237"
	"\220\167\071\022\027\374\362\321\166\231\142\112\062\321\266\267"
	"\310\145\076\272\150\141\367\036\207\223\145\266\313\034\125\133"
	"\224\217\155\254\213\137\175\002\371\340\114\053\262\003\342\173"
	"\150\041\065\321\203\054\360\013\300\126\301\213\163\027\346\007"
	"\246\124\263\061\264\061\064\255\021\200\331\304\204\273\077\355"
	"\335\164\276\140\241\257\153\141\005\055\355\170\104\323\200\352"
	"\050\063\034\334\144\120\211\166\321\142\072\125\036\171\103\373"
	"\355\002\134\217\261\310\361\266\365\336\057\071\262\257\044\333"
	"\342\100\267\107\220\101\275\142\244\367\270\302\160\373\276\136"
	"\375\033\356\256\343\337\145\331\276\225\022\161\104\067\114\047"
	"\167\004\157\010\105\054\152\351\044\042\254\225\036\152\363\033"
	"\206\341\312\151\301\057\102\200\304\125\361\011\214\076\061\004"
	"\102\240\015\210\315\170\161\361\232\035\206\271\210\172\324\017"
	"\134\236\170\035\316\273\236\222\021\220\234\236\316\315\243\021"
	"\155\260\231\073\050\012\054\303\050\262\174\261\055\120\300\211"
	"\357\071\247\275\365\105\120\006\325\355\244\243\272\107\265\050"
	"\370\116\143\041\131\220\344\201\103\141\063\160\262\364\371\241"
	"\056\241\137\043\346\260\052\273\235\316\137\127\026\024\200\017"
	"\143\344\060\274\164\024\075\267\165\161\050\050\145\042\311\224"
	"\303\050\267\251\331\341\145\166\260\305\316\307\332\116\327\075"
	"\063\007\371\250\034\067\137\222\250\210\272\016\252\203\242\156"
	"\254\132\027\205\074\175\374\355\103\312\264\035\031\214\132\114"
	"\223\124\364\257\213\124\102\064\335\374\103\207\200\345\365\055"
	"\100\015\263\175\213\257\152\316\171\037\354\222\253\107\337\076"
	"\233\324\356\047\051\060\133\006\054\236\215\255\204\203\332\305"
	"\221\215\102\034\074\254\353\266\313\330\110\166\037\050\265\272"
	"\374\244\342\045\324\075\054\001\334\271\256\140\075\210\045\317"
	"\025\150\353\122\024\327\010\340\257\121\127\316\171\014\211\166"
	"\260\154\234\205\251\310\206\206\202\064\346\300\275\014\217\323"
	"\164\173\045\211\122\055\151\002\177\300\321\371\315\133\157\176"
	"\307\014\004\161\325\212\367\127\277\336\030\175\352\247\120\137"
	"\042\165\351\165\243\122\170\043\023\111\034\341\244\213\137\154"
	"\230\143\335\155\356\324\305\256\262\336\053\235\205\173\375\250"
	"\361\346\036\225\070\226\270\114\337\325\055\204\140\215\360\371"
	"\361\316\147\340\242\055\216\125\013\272\363\220\066\360\071\050"
	"\326\127\276\017\355\166\134\315\114\211\122\254\027\102\246\011"
	"\020\015\352\263\073\170\011\106\063\374\327\151\354\020\221\303"
	"\150\117\322\126\306\057\043\022\271\165\277\320\270\146\332\311"
	"\164\304\175\257\075\206\365\160\203\315\332\157\335\153\063\106"
	"\273\006\234\202\065\277\225\356\065\125\277\356\274\231\267\060"
	"\135\065\340\233\274\326\013\077\243\346\256\201\121\342\307\015"
	"\350\143\220\035\043\046\013\131\174\312\107\071\144\377\151\302"
	"\065\112\135\361\040\151\060\303\117\337\104\241\301\013\257\251"
	"\157\100\307\222\147\322\354\343\235\063\034\001\063\206\303\150"
	"\320\041\131\360\212\211\264\332\151\370\173\052\004\053\324\163"
	"\153\233\006\322\155\362\265\013\046\322\015\131\131\321\302\052"
	"\362\034\032\175\246\317\127\017\307\323\072\314\376\016\077\151"
	"\251\105\074\027\070\362\042\136\304\057\270\036\000\173\110\363"
	"\157\206\130\312\065\133\031\204\011\372\007\211\270\204\042\111"
	"\227\153\330\131\327\162\370\232\075\067\254\051\334\326\121\116"
	"\332\246\350\216\170\037\101\015\053\335\347\166\145\317\236\222"
	"\113\157\057\352\236\034\337\220\012\230\000\055\237\154\276\222"
	"\251\210\045\004\064\021\253\266\354\151\023\141\004\155\060\307"
	"\373\264\073\040\273\152\227\122\370\064\300\326\250\136\235\032"
	"\226\263\201\154\323\053\333\331\271\104\330\141\227\362\216\321"
	"\233\253\152\364\306\000\260\340\226\363\267\172\004\347\256\002"
	"\244\061\336\314\257\056\146\164\161\365\225\073\327\312\335\364"
	"\035\004\376\311\346\275\315\373\004\164\312\207\161\177\234\202"
	"\164\221\024\245\376\171\046\113\044\362\273\311\274\241\316\224"
	"\303\040\165\355\324\240\172\364\156\164\072\224\164\101\240\224"
	"\131\304\260\072\230\232\064\252\061\271\020\163\277\333\371\123"
	"\107\355\257\030\360\007\113\001\342\116\134\016\307\354\252\206"
	"\372\374\314\210\314\327\122\213\353\161\300\046\140\035\023\252"
	"\363\101\357\052\236\033\222\160\205\043\344\214\364\277\373\325"
	"\323\025\372\111\020\234\275\007\137\151\363\142\156\131\150\314"
	"\343\360\136\023\003\131\104\324\376\041\162\136\254\244\113\064"
	"\330\067\011\033\324\205\342\202\234\222\241\012\025\244\107\013"
	"\143\176\154\014\053\037\270\043\000\321\006\221\335\246\304\243"
	"\154\175\360\152\211\305\314\322\216\161\323\053\175\072\322\235"
	"\267\075\204\267\125\134\013\114\260\256\037\325\205\210\013\310"
	"\272\202\363\065\321\223\075\362\250\373\335\224\026\362\064\100"
	"\356\335\021\252\037\247\373\347\051\023\072\103\026\355\351\111"
	"\007\346\157\217\003\201\120\310\374\213\043\040\302\175\223\271"
	"\254\352\166\075\054\111\044\101\134\040\216\330\220\077\112\204"
	"\236\370\246\347\110\072\071\353\372\230\171\166\160\006\356\277"
	"\302\151\154\102\200\046\176\021\361\323\342\224\353\272\342\136"
	"\047\073\130\020\237\106\312\362\157\323\131\002\367\377\376\261"
	"\230\242\225\021\102\333\202\255\022\055\071\075\330\071\106\156"
	"\206\054\074\245\140\134\001\364\326\336\043\161\213\264\023\215"
	"\272\213\215\131\157\251\252\116\202\354\231\056\226\124\042\061"
	"\304\055\001\066\224\157\057\000\035\142\324\344\135\125\014\017"
	"\304\133\054\354\177\066\104\267\271\352\305\053\030\215\371\376"
	"\116\230\346\224\221\236\221\003\135\344\355\362\243\271\242\164"
	"\137\353\230\035\051\130\361\013\114\222\113\247\165\216\301\002"
	"\313\242\067\335\365\370\210\153\043\017\230\074\375\244\206\040"
	"\270\361\170\247\326\327\304\342\273\341\074\165\030\304\302\256"
	"\025\171\006\165\206\015\377\026\054\327\117\225\146\276\241\065"
	"\234\325\044\270\025\326\145\105\355\215\137\040\061\137\146\362"
	"\327\214\064\365\333\335\146\334\315\044\324\176\223\204\055\062"
	"\161\060\323\213\362\365\270\137\263\205\105\275\217\267\350\301"
	"\336\137\056\022\275\023\240\065\243\244\234\052\000\276\173\326"
	"\162\012\151\365\047\100\337\162\345\022\376\370\300\304\036\160"
	"\037\371\345\330\200\046\041\056\346\230\154\232\343\340\355\236"
	"\237\003\203\074\366\267\352\131\167\251\145\257\130\336\315\240"
	"\001\167\113\302\240\206\270\163\005\310\200\330\257\130\030\023"
	"\053\021\020\371\065\374\100\243\314\176\073\174\305\025\214\016"
	"\175\202\150\066\006\242\351\101\016\167\004\327\226\105\021\311"
	"\261\315\215\232\325\343\307\306\130\035\204\333\025\025\337\075"
	"\154\122\050\100\234\076\027\131\017\234\210\220\246\262\216\050"
	"\230\127\134\235\305\256\131\142\100\172\176\142\202\161\362\230"
	"\324\060\335\364\004\354\205\163\007\166\053\303\147\216\320\026"
	"\144\065\263\367\174\154\236\027\062\031\023\104\136\116\303\017"
	"\320\351\333\057\202\377\240\375\245\045\070\140\256\263\375\101"
	"\321\322\371\053\056\041\266\300\135\236\041\314\234\151\373\325"
	"\163\373\263\071\335\132\360\256\034\324\101\026\132\333\137\355"
	"\265\263\337\135\102\301\170\047\332\243\326\020\216\357\321\066"
	"\110\300\116\307\131\042\304\070\365\123\231\132\151\006\115\350"
	"\107\066\143\211\125\150\055\232\327\341\336\114\027\246\126\360"
	"\100\045\136\073\333\124\105\130\073\372\257\101\067\226\136\137"
	"\063\261\061\202\064\040\143\053\205\213\176\364\211\172\244\332"
	"\221\164\026\043\353\376\034\015\025\063\242\065\135\072\364\364"
	"\146\121\107\240\167\273\071\163\247\015\020\135\246\142\140\312"
	"\007\332\036\246\313\355\310\361\362\277\073\376\147\161\075\133"
	"\324\162\254\021\053\142\205\046\355\154\114\056\233\273\070\064"
	"\345\221\353\124\343\114\242\164\336\035\015\176\355\161\332\107"
	"\153\221\352\331\067\371\356\364\152\267\104\214\220\375\172\266"
	"\326\344\162\055\072\055\176\202\245\034\055\046\050\244\100\316"
	"\276\223\126\170\107\060\053\127\145\353\013\253\245\232\052\207"
	"\202\155\337\360\156\203\105\214\141\061\161\372\311\045\224\321"
	"\243\312\053\265\046\304\351\012\032\317\356\141\371\333\337\154"
	"\261\344\006\133\034\355\116\375\215\150\023\206\000\114\067\270"
	"\026\345\005\173\067\012\126\267\212\273\043\065\122\244\111\354"
	"\371\121\363\271\234\123\102\175\345\352\176\015\057\062\257\062"
	"\103\325\251\305\020\115\350\361\221\220\327\062\325\103\206\054"
	"\374\254\175\027\137\336\334\103\377\021\253\034\045\241\201\326"
	"\031\222\132\131\054\330\066\150\232\273\264\300\266\170\066\254"
	"\133\064\120\366\342\357\230\270\262\327\137\325\231\127\334\022"
	"\223\057\045\121\044\070\137\334\372\252\253\200\023\136\374\045"
	"\046\007\074\315\113\345\162\212\271\360\367\263\310\052\011\331"
	"\270\153\027\355\172\072\023\105\203\256\303\016\241\303\104\357"
	"\006\172\144\016\251\214\052\024\037\106\331\374\213\161\037\057"
	"\074\160\360\121\056\126\304\366\317\344\343\122\021\061\251\340"
	"\214\243\030\003\014\066\033\177\172\257\273\055\207\354\323\006"
	"\301\144\064\143\300\213\072\164\344\267\101\154\264\125\040\360"
	"\371\142\255\277\355\115\241\275\171\044\354\053\171\161\051\236"
	"\156\120\332\052\366\221\112\373\106\233\041\273\131\146\355\123"
	"\351\340\303\261\260\240\315\303\210\243\341\241\201\275\325\273"
	"\047\165\321\363\240\111\140\264\125\110\000\263\342\245\013\243"
	"\046\035\122\052\365\006\266\223\163\302\257\106\212\316\150\033"
	"\343\032\060\133\245\107\064\167\242\014\307\336\074\072\313\130"
	"\310\340\211\062\125\060\257\024\263\271\343\360\212\274\265\372"
	"\007\342\331\047\152\335\067\056\227\053\356\151\233\124\036\227"
	"\073\156\154\051\034\247\175\236\134\261\273\234\014\067\232\323"
	"\030\357\332\127\073\132\313\323\271\025\150\330\024\134\067\122"
	"\311\025\076\132\124\272\352\055\107\167\150\007\075\021\177\171"
	"\222\036\333\071\067\134\326\174\332\276\326\255\064\157\051\323"
	"\052\355\267\232\217\143\006\135\366\346\353\336\331\025\324\205"
	"\324\355\324\217\012\257\327\055\250\110\152\315\014\036\302\277"
	"\312\363\114\053\345\307\141\254\063\176\112\160\140\253\104\315"
	"\003\335\353\215\063\374\107\154\240\020\264\134\147\166\177\245"
	"\017\073\124\112\201\100\135\016\353\050\210\230\122\004\042\201"
	"\250\113\317\347\135\327\225\313\101\163\074\234\044\277\020\015"
	"\047\002\217\272\356\156\004\144\247\054\057\344\171\351\360\336"
	"\124\025\127\105\372\312\146\047\150\113\333\054\166\122\330\376"
	"\355\307\001\102\177\311\316\365\133\277\323\073\070\276\052\360"
	"\275\105\033\103\015\154\246\007\233\145\216\106\131\035\046\054"
	"\067\055\245\045\341\257\113\277\006\161\223\155\100\211\071\355"
	"\153\026\024\140\025\141\221\177\131\164\066\007\060\044\204\230"
	"\047\015\067\116\205\056\116\375\242\063\263\241\364\251\061\270"
	"\362\153\167\261\151\371\152\370\204\361\021\310\074\210\253\133"
	"\021\321\072\135\104\056\052\021\242\373\101\330\332\003\003\155"
	"\304\367\323\116\002\165\056\242\113\337\237\303\001\324\023\341"
	"\230\220\270\167\017\074\014\236\206\224\137\312\107\253\207\057"
	"\124\331\122\277\110\154\325\361\043\144\204\266\217\137\223\223"
	"\045\300\214\305\063\375\106\372\017\352\371\035\030\117\006\124"
	"\013\122\225\232\114\064\063\312\311\270\163\063\252\347\013\255"
	"\202\131\362\150\112\114\061\147\207\257\230\105\051\037\115\374"
	"\327\364\233\111\061\310\154\202\054\223\150\112\304\014\222\204"
	"\247\136\331\037\010\026\321\362\051\260\044\106\043\306\357\243"
	"\165\061\036\231\171\100\320\203\247\235\111\267\101\374\335\310"
	"\342\113\140\133\026\027\000\257\232\335\204\330\166\355\050\274"
	"\304\210\105\304\046\262\016\053\377\066\340\142\335\045\122\152"
	"\262\132\016\040\350\051\202\003\146\041\331\377\317\237\020\111"
	"\122\140\220\255\226\232\343\304\003\022\014\202\232\035\060\263"
	"\146\162\170\133\112\211\273\253\177\346\014\262\072\132\042\267"
	"\213\032\323\153\037\327\376\200\047\107\214\050\271\157\224\071"
	"\021\043\065\243\103\370\104\066\152\232\017\174\373\302\307\146"
	"\353\151\156\077\223\140\215\001\052\074\304\263\305\066\122\225"
	"\002\114\022\332\025\246\006\267\273\322\233\353\212\043\253\030"
	"\344\323\151\063\255\331\263\074\176\375\150\362\355\221\024\326"
	"\343\314\115\255\163\072\153\100\164\315\333\144\027\170\354\141"
	"\206\251\320\332\053\373\277\314\013\150\374\232\265\154\354\152"
	"\227\305\006\353\122\332\043\337\356\266\154\165\363\121\003\351"
	"\347\144\026\116\047\153\000\306\325\350\057\203\013\146\214\323"
	"\304\144\034\203\141\257\276\002\076\061\336\336\147\361\312\361"
	"\110\275\060\101\257\061\333\253\360\073\324\333\004\314\042\050"
	"\030\062\051\221\226\256\346\070\150\315\045\176\217\033\356\131"
	"\373\041\233\164\206\356\073\020\302\163\335\350\207\331\332\303"
	"\120\236\157\014\111\117\357\065\145\064\141\366\057\035\334\311"
	"\104\055\244\241\014\256\062\134\255\300\103\164\111\107\037\314"
	"\112\023\363\051\220\252\151\235\320\074\105\032\131\313\364\213"
	"\106\154\273\121\024\131\115\057\254\101\114\024\140\137\356\011"
	"\070\110\020\057\252\032\224\164\046\104\364\210\335\121\252\254"
	"\055\114\271\107\266\122\332\060\176\177\147\275\266\041\005\325"
	"\202\350\315\144\010\167\224\135\300\331\177\305\302\107\210\017"
	"\060\365\361\047\024\075\155\075\264\115\307\112\071\312\336\006"
	"\047\355\001\101\021\314\322\030\206\007\237\231\322\150\315\343"
	"\373\041\340\107\374\101\042\346\160\161\121\355\113\053\042\211"
	"\026\176\205\071\311\313\172\204\051\174\215\235\157\047\040\223"
	"\332\257\102\253\376\271\147\231\143\142\305\021\345\133\363\275"
	"\163\363\067\235\137\346\253\360\076\256\146\071\052\332\130\006"
	"\327\301\105\244\235\156\356\157\112\122\120\225\321\073\236\073"
	"\261\061\306\052\004\345\206\163\071\326\113\120\270\024\221\132"
	"\007\037\202\062\003\210\303\154\301\370\236\100\237\115\150\014"
	"\261\240\324\177\310\126\253\317\103\253\105\131\024\006\204\253"
	"\363\333\205\116\002\256\002\321\041\302\216\173\126\357\202\242"
	"\127\114\222\261\111\245\251\046\070\244\022\270\057\075\133\031"
	"\033\143\113\123\033\204\111\307\156\151\356\341\123\032\065\311"
	"\330\354\177\354\316\020\023\026\102\375\366\143\243\237\224\303"
	"\304\156\273\371\127\366\335\170\357\165\356\144\072\123\275\064"
	"\000\175\355\324\141\047\266\025\336\061\153\073\072\064\204\106"
	"\010\105\240\013\304\125\244\202\045\001\063\312\315\360\310\322"
	"\055\313\125\240\077\054\311\361\223\261\126\354\324\323\013\263"
	"\171\111\112\005\122\124\310\122\002\317\227\343\004\105\022\041"
	"\170\125\356\346\031\064\020\014\356\007\133\207\246\306\227\020"
	"\333\300\163\263\137\350\341\026\153\143\345\253\330\005\370\071"
	"\323\231\053\004\142\074\037\007\257\167\057\354\005\003\065\304"
	"\247\232\370\157\021\350\222\042\363\101\356\265\250\116\315\130"
	"\143\156\207\247\323\240\205\171\153\246\254\224\236\374\154\152"
	"\042\347\326\364\270\000\101\327\061\107\314\051\126\114\210\126"
	"\040\071\245\325\265\001\237\167\106\055\255\103\130\031\110\175"
	"\022\274\105\165\003\200\177\265\351\114\130\362\207\015\306\152"
	"\133\334\027\337\000\344\215\076\207\137\247\132\034\360\276\207"
	"\152\166\241\271\163\105\113\005\270\312\335\362\235\152\255\107"
	"\265\077\346\362\071\372\245\075\061\215\204\327\065\301\375\045"
	"\125\044\036\154\251\315\251\154\240\343\123\022\232\222\344\041"
	"\051\062\243\163\007\072\020\046\353\175\121\075\353\264\240\312"
	"\344\007\012\322\206\015\276\331\031\211\107\160\330\171\166\252"
	"\357\363\342\157\344\174\120\044\274\104\013\144\012\024\364\366"
	"\201\030\016\142\334\225\301\140\134\266\052\262\267\160\274\163"
	"\002\314\325\003\304\027\112\305\047\227\322\164\061\305\043\222"
	"\001\234\176\170\321\062\362\344\012\202\354\064\162\302\177\304"
	"\006\153\353\131\050\010\272\235\237\110\016\267\273\274\263\231"
	"\106\136\101\367\027\011\375\315\337\040\130\254\315\227\017\151"
	"\366\164\255\271\373\272\316\110\070\062\021\001\002\045\266\370"
	"\321\157\240\300\371\353\045\071\225\221\030\332\213\251\177\156"
	"\310\073\053\337\037\121\337\062\254\056\126\046\155\004\027\127"
	"\130\103\307\122\252\213\370\074\136\044\161\031\261\247\316\206"
	"\264\355\067\371\234\372\334\005\242\135\201\317\146\351\232\231"
	"\267\157\372\220\022\001\066\352\004\127\012\276\276\072\370\055"
	"\043\125\031\312\274\120\361\260\373\050\005\065\072\011\036\160"
	"\363\374\342\300\136\075\130\262\162\272\014\332\246\136\014\030"
	"\277\126\124\217\216\166\307\352\216\120\107\060\040\041\134\172"
	"\213\206\312\317\373\313\226\112\301\207\107\224\142\270\342\375"
	"\055\114\212\015\322\375\134\335\055\170\263\276\315\262\004\231"
	"\341\216\222\150\133\054\222\031\373\224\001\050\104\366\333\331"
	"\157\257\034\344\007\360\330\257\051\326\202\102\265\163\116\015"
	"\001\040\142\356\101\246\034\126\102\346\346\072\072\162\104\237"
	"\235\120\254\316\064\042\202\320\357\134\376\140\256\076\254\262"
	"\276\134\306\216\044\053\102\162\234\314\332\047\115\175\150\215"
	"\203\204\224\076\137\016\262\327\065\204\044\124\045\113\105\333"
	"\355\175\154\367\075\373\063\242\364\112\035\336\312\203\077\261"
	"\031\072\102\052\215\075\051\260\242\141\132\225\357\242\037\322"
	"\151\343\374\073\234\154\217\260\176\006\255\225\246\124\114\062"
	"\226\267\223\126\146\353\374\270\222\155\120\344\356\201\062\001"
	"\213\126\260\073\060\220\041\062\311\171\062\153\125\365\206\017"
	"\310\270\242\315\022\154\072\140\326\261\020\070\203\242\275\001"
	"\175\005\047\213\100\110\343\117\011\025\155\175\101\352\105\266"
	"\004\303\257\332\301\347\256\124\151\257\125\304\127\020\215\033"
	"\154\334\074\263\206\031\234\332\377\024\201\362\233\056\250\065"
	"\314\375\205\225\051\077\066\316\106\013\261\174\010\315\255\366"
	"\322\321\274\212\232\051\101\123\053\176\373\311\075\110\245\037"
	"\357\164\012\222\005\154\306\241\063\325\200\151\065\134\061\152"
	"\104\205\107\333\074\163\367\014\221\143\004\120\060\007\021\066"
	"\004\352\343\304\356\212\071\036\123\250\044\371\147\075\215\307"
	"\013\346\006\131\270\033\260\074\066\361\134\043\101\222\346\076"
	"\074\144\370\125\375\335\033\334\251\056\323\376\261\363\230\035"
	"\074\233\226\363\127\050\311\011\274\106\175\376\253\142\007\324"
	"\230\377\337\051\173\131\233\054\245\300\343\136\304\276\236\313"
	"\026\167\164\314\167\263\246\123\237\212\064\225\033\137\063\305"
	"\177\042\255\061\346\356\276\215\042\114\173\123\264\162\254\103"
	"\326\275\167\166\034\350\207\037\156\066\313\223\043\142\145\012"
	"\050\043\122\064\214\030\122\023\311\252\171\054\026\125\304\356"
	"\225\234\360\122\145\372\152\225\167\010\161\103\300\176\047\254"
	"\035\044\305\020\361\357\306\122\213\147\147\340\010\275\071\130"
	"\353\304\155\246\206\165\042\212\145\263\115\143\011\067\207\120"
	"\075\237\306\266\352\200\150\010\076\127\207\124\022\325\137\106"
	"\052\203\051\166\310\233\152\270\313\310\225\152\006\217\070\063"
	"\103\331\252\306\076\003\170\167\025\254\373\250\245\156\207\317"
	"\016\072\027\051\212\003\264\022\264\047\122\305\051\124\076\207"
	"\172\244\217\137\022\056\121\340\170\023\026\070\102\201\114\070"
	"\333\016\134\107\163\304\302\360\272\166\056\333\014\377\312\307"
	"\301\065\362\073\004\201\136\247\267\364\071\213\013\114\152\144"
	"\332\045\216\353\203\061\117\307\277\357\045\032\245\154\331\047"
	"\371\350\134\352\217\243\251\227\012\134\035\310\206\116\200\357"
	"\135\213\173\311\052\135\146\013\072\076\151\051\200\013\112\172"
	"\232\050\314\041\263\030\373\342\073\225\270\053\204\017\052\126"
	"\364\200\343\252\253\045\063\171\023\135\223\320\176\063\030\104"
	"\036\223\015\266\375\156\010\317\217\237\105\153\141\226\312\247"
	"\056\007\124\221\255\206\072\037\046\216\143\031\112\301\234\320"
	"\174\005\224\210\110\127\161\057\060\107\075\010\234\237\346\334"
	"\011\036\322\200\103\061\366\004\177\375\063\277\120\242\210\354"
	"\361\170\131\252\145\103\145\153\125\132\253\211\353\341\213\261"
	"\326\015\341\064\225\133\317\010\367\100\075\165\104\157\244\140"
	"\173\256\366\217\162\045\330\024\341\010\343\315\334\351\002\144"
	"\123\225\176\165\355\363\342\307\330\167\106\270\355\313\050\106"
	"\241\210\251\264\030\072\267\337\012\105\264\126\345\215\310\343"
	"\253\135\056\134\377\231\133\260\156\003\377\112\337\045\124\127"
	"\157\333\172\237\100\021\072\236\130\054\032\350\150\025\171\212"
	"\143\200\105\203\105\241\040\060\017\311\004\351\376\206\152\317"
	"\263\333\127\345\207\143\122\340\254\021\063\106\157\201\156\155"
	"\347\345\120\125\264\267\201\151\056\332\224\372\325\236\227\241"
	"\203\370\061\300\341\355\057\166\365\325\344\104\353\060\204\076"
	"\223\153\000\213\071\230\364\222\060\203\263\313\360\055\026\220"
	"\310\127\341\220\006\065\364\156\024\273\351\333\064\121\171\156"
	"\221\130\237\012\025\327\240\357\310\123\010\332\142\322\267\001"
	"\040\037\317\130\363\174\364\122\071\343\260\177\140\107\170\301"
	"\232\005\030\067\155\236\350\233\314\136\126\366\356\166\130\224"
	"\301\337\215\217\243\146\372\216\174\057\331\354\172\300\305\301"
	"\060\263\027\061\011\166\005\031\364\205\226\163\016\232\350\077"
	"\131\366\276\345\225\034\347\013\261\305\304\332\126\006\211\232"
	"\004\025\221\253\331\217\221\244\007\003\030\207\261\256\324\341"
	"\070\111\275\051\236\135\246\127\224\301\213\004\334\006\313\157"
	"\162\345\137\145\245\125\344\315\026\351\316\014\145\364\055\124"
	"\043\014\175\052\245\156\035\141\170\251\077\007\123\023\255\054"
	"\350\357\202\314\246\313\177\157\036\255\352\343\273\127\073\176"
	"\257\015\137\027\316\173\032\036\224\020\216\270\106\113\354\072"
	"\064\343\232\323\140\236\266\301\011\237\055\151\250\273\256\213"
	"\375\227\147\122\126\332\011\062\270\067\054\166\222\164\020\124"
	"\335\034\361\171\176\320\026\262\175\076\022\343\073\302\330\124"
	"\227\162\231\350\050\254\070\200\027\152\030\362\261\026\224\107"
	"\243\135\331\162\247\220\167\277\343\044\246\372\354\064\246\316"
	"\003\144\066\103\374\022\136\363\237\251\033\043\245\063\152\165"
	"\071\044\033\262\031\265\066\366\020\023\152\036\120\017\045\141"
	"\105\364\052\144\117\051\232\020\317\064\075\350\365\070\112\127"
	"\340\312\063\153\251\004\074\240\041\071\024\154\373\006\102\301"
	"\273\262\077\210\115\377\237\271\360\104\216\041\054\321\155\376"
	"\253\213\054\204\034\316\215\150\237\233\007\053\105\013\350\073"
	"\151\076\003\252\016\020\200\200\304\133\010\335\374\320\037\146"
	"\365\356\307\302\242\071\061\030\317\202\105\273\346\257\245\261"
	"\212\342\372\163\370\143\133\005\044\004\375\112\003\363\354\133"
	"\167\057\320\252\013\266\333\107\116\102\021\135\337\022\354\356"
	"\072\171\275\130\102\062\210\035\055\326\361\271\060\016\344\036"
	"\161\017\126\051\212\170\252\267\070\271\223\226\261\370\076\214"
	"\275\151\057\063\323\104\026\006\316\056\032\031\222\266\045\314"
	"\372\237\043\174\045\050\120\065\174\324\117\215\066\153\161\125"
	"\056\367\203\053\137\103\261\151\334\221\104\325\331\060\012\316"
	"\066\131\342\100\047\335\166\012\040\265\056\266\321\140\051\254"
	"\023\340\336\310\303\026\071\137\016\063\144\060\231\177\077\021"
	"\126\362\165\305\226\224\301\075\313\315\251\161\372\134\023\262"
	"\236\107\016\337\322\234\360\126\241\053\111\064\226\234\301\260"
	"\007\355\264\174\073\116\243\220\066\017\243\014\007\050\163\267"
	"\051\356\323\304\357\057\275\201\005\076\207\067\032\140\342\011"
	"\203\152\045\304\250\336\255\215\237\203\327\135\345\213\112\314"
	"\114\000\205\373\157\032\261\226\300\050\043\326\033\301\312\312"
	"\064\201\264\302\035\200\347\245\206\262\374\361\042\064\210\213"
	"\161\335\334\053\307\246\041\353\167\330\012\306\301\304\046\216"
	"\072\171\146\347\074\240\222\070\320\167\310\063\222\362\203\273"
	"\042\202\162\042\371\326\004\100\103\120\365\016\105\020\236\236"
	"\051\045\333\056\345\074\140\023\302\000\045\201\246\111\242\303"
	"\067\213\006\341\370\333\160\313\017\365\236\333\156\160\102\156"
	"\157\270\012\065\125\140\235\010\130\376\020\021\201\020\027\274"
	"\374\146\260\022\055\220\314\101\135\132\150\217\156\127\377\377"
	"\036\372\014\202\206\263\326\134\261\243\043\235\330\260\320\057"
	"\120\265\345\133\235\314\045\160\140\036\316\063\272\304\201\351"
	"\304\333\157\124\371\052\074\341\215\344\300\224\104\245\026\166"
	"\343\353\234\045\221\372\255\216\037\152\200\116\312\376\135\127"
	"\106\177\055\314\221\330\235\033\277\031\075\025\001\300\022\377"
	"\233\074\063\142\130\170\346\314\135\211\062\215\306\014\320\030"
	"\344\147\042\156\160\165\124\357\040\136\055\170\165\223\335\332"
	"\115\275\361\067\341\304\047\154\042\145\352\163\236\356\011\137"
	"\204\156\106\126\156\337\351\107\266\363\057\024\321\303\060\346"
	"\276\376\120\311\110\244\057\041\234\375\065\103\105\111\355\015"
	"\117\216\020\311\153\040\140\311\365\046\052\321\021\275\267\105"
	"\013\336\356\176\233\273\346\173\366\305\103\351\204\217\131\310"
	"\022\010\254\366\162\340\212\107\273\114\176\346\330\147\245\160"
	"\125\304\170\361\136\150\323\105\165\136\050\331\043\265\366\054"
	"\041\251\053\224\346\377\060\010\013\350\257\231\236\355\150\174"
	"\067\225\267\321\101\162\077\221\104\372\105\200\126\064\105\222"
	"\134\041\374\163\145\120\167\030\042\325\023\262\316\034\030\350"
	"\052\022\201\277\072\307\140\227\317\334\134\112\127\247\362\064"
	"\325\364\047\222\027\313\233\105\117\047\144\043\227\026\374\272"
	"\364\366\155\115\141\033\314\122\013\332\322\141\062\027\367\114"
	"\024\245\004\312\035\340\242\331\257\340\102\177\157\261\372\271"
	"\234\273\031\225\061\247\020\310\325\057\043\247\066\305\267\156"
	"\322\215\045\344\222\271\357\121\004\337\064\134\107\303\010\345"
	"\017\341\147\210\111\263\165\117\223\122\255\117\367\265\315\353"
	"\241\010\105\247\046\143\362\306\024\051\102\144\112\073\377\253"
	"\153\354\346\376\337\177\076\261\150\045\235\165\154\202\325\240"
	"\145\302\251\045\227\070\233\214\045\236\152\026\301\322\360\061"
	"\124\041\310\051\073\112\275\251\112\041\341\172\115\155\177\227"
	"\143\160\076\062\310\116\372\234\210\306\232\226\005\004\077\113"
	"\100\126\204\062\171\343\367\250\234\025\251\027\136\234\257\301"
	"\015\356\363\326\074\356\162\304\264\015\132\272\021\231\006\122"
	"\360\212\204\151\155\174\022\012\222\274\041\360\130\321\261\146"
	"\277\245\075\373\223\257\277\107\274\032\002\316\264\010\040\244"
	"\223\245\016\001\042\041\013\264\335\055\244\066\376\125\234\276"
	"\373\331\271\216\211\171\326\106\224\330\024\110\341\065\355\164"
	"\333\374\166\375\035\201\261\372\256\125\060\255\253\315\153\246"
	"\246\045\065\060\237\014\166\063\344\212\174\306\300\151\073\233"
	"\145\261\230\202\062\112\175\341\240\255\216\113\172\372\362\041"
	"\037\050\121\276\064\307\362\031\122\156\337\022\327\032\256\075"
	"\313\107\300\376\221\075\337\061\353\156\175\146\150\160\207\207"
	"\230\331\106\314\240\070\345\363\247\305\006\176\337\265\274\253"
	"\374\174\251\216\272\211\300\245\367\075\013"
#define      xecc_z	15
#define      xecc	((&data[6788]))
	"\347\106\143\311\015\255\162\253\226\213\111\351\003\232\136\331"
	"\036\154\056"
#define      msg1_z	65
#define      msg1	((&data[6805]))
	"\274\144\337\034\242\157\334\016\024\265\056\076\371\276\011\357"
	"\217\157\013\164\240\051\272\373\253\140\357\173\157\043\053\066"
	"\010\113\066\364\004\241\176\303\007\322\350\333\202\170\363\370"
	"\200\165\232\223\274\120\235\244\343\045\226\040\042\221\242\035"
	"\045\370\000\016\276\007\215"
#define      rlax_z	1
#define      rlax	((&data[6876]))
	"\306"
#define      inlo_z	3
#define      inlo	((&data[6877]))
	"\242\052\266"
#define      chk2_z	19
#define      chk2	((&data[6881]))
	"\175\225\300\152\221\366\171\266\245\217\256\365\374\261\361\356"
	"\062\344\110\326\007\045"
#define      chk1_z	22
#define      chk1	((&data[6903]))
	"\324\105\366\245\251\273\353\327\030\346\332\263\045\064\260\206"
	"\373\117\247\053\267\316\244\362"
#define      tst2_z	19
#define      tst2	((&data[6929]))
	"\060\352\113\353\037\052\222\034\115\207\164\325\072\173\270\104"
	"\153\306\213\037\013\323\075"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define HARDENINGSP	0	/* Define as 1 to disable bash child process */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a processs */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;

    int lentmp = len;

#if HARDENINGSP
    //Start tracing to protect from dump & trace
    if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }

    //Decode Bash
    while (len > 0) {
        indx++;
        tmp = stte[indx];
        jndx += tmp;
        stte[indx] = stte[jndx];
        stte[jndx] = tmp;
        tmp += stte[indx];
        *ptr ^= stte[tmp];
        ptr++;
        len--;
    }

    //Exec bash script
    system(tmp2);

    //Empty script variable
    memcpy(tmp2, str, lentmp);

    //Sinal to detach ptrace
    ptrace(PTRACE_DETACH, 0, 0, 0);
    exit(0);

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
#endif /* HARDENINGSP Exit here anyway*/

    int pid, status;
    pid = fork();

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            printf("Operation not permitted\n");
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Exec bash script
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {
        wait(&status);
    }

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
} 
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
